<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>功能更新测试</title>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f7fa;
        }
        
        .test-container {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .test-title {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: bold;
        }
        
        .update-list {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .update-list h4 {
            margin: 0 0 10px 0;
            color: #2d5a2d;
        }
        
        .update-list ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .update-list li {
            margin-bottom: 5px;
            color: #2d5a2d;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-title">📱 功能更新测试</div>
        
        <div class="update-list">
            <h4>✅ 已完成的更新：</h4>
            <ul>
                <li>移除了"全部展开"按钮</li>
                <li>已发布视频的四个量（浏览量、点赞量、评论量、转发量）现在显示在卡片外面</li>
                <li>展开按钮点击后会变蓝色，折叠后恢复默认颜色</li>
                <li>只有已发布的视频才会显示外部的四个量</li>
            </ul>
        </div>
        
        <div class="mobile-table-container" id="mobileTableContainer">
            <!-- 卡片将在这里动态生成 -->
        </div>
    </div>

    <script src="js/app.js"></script>
    <script>
        // 测试数据
        let videoData = [
            {
                "视频名称": "未开始的视频",
                "剧本完成进度": "",
                "来访拍摄进度": "",
                "剪辑进度": "",
                "审核进度": "",
                "发布进度": "",
                "发布时间": "",
                "浏览量": "",
                "点赞量": "",
                "评论量": "",
                "转发量": ""
            },
            {
                "视频名称": "进行中的视频",
                "剧本完成进度": "完成",
                "来访拍摄进度": "完成",
                "剪辑进度": "未完成",
                "审核进度": "",
                "发布进度": "",
                "发布时间": "",
                "浏览量": "",
                "点赞量": "",
                "评论量": "",
                "转发量": ""
            },
            {
                "视频名称": "已发布的视频",
                "剧本完成进度": "完成",
                "来访拍摄进度": "完成",
                "剪辑进度": "完成",
                "审核进度": "完成",
                "发布进度": "完成",
                "发布时间": "2024-01-15",
                "浏览量": "12500",
                "点赞量": "890",
                "评论量": "156",
                "转发量": "78"
            }
        ];

        // 渲染移动端卡片
        function renderMobileCards() {
            const container = document.getElementById('mobileTableContainer');
            container.innerHTML = '';
            
            videoData.forEach((item, index) => {
                const card = createMobileCard(item, index);
                container.appendChild(card);
            });
        }

        // 重写updateData函数以适应测试
        function updateData(index, field, value) {
            if (videoData[index]) {
                videoData[index][field] = value;
                
                // 如果发布进度改变，需要重新渲染整个卡片
                if (field === '发布进度') {
                    renderMobileCards();
                } else {
                    // 更新卡片样式
                    const mobileCard = document.querySelector(`input.mobile-card-checkbox[data-index="${index}"]`)?.closest('.mobile-card');
                    if (mobileCard) {
                        mobileCard.className = 'mobile-card';
                        if (videoData[index].发布进度 === '完成') {
                            mobileCard.classList.add('completed');
                        } else if (videoData[index].剧本完成进度 === '未完成' || videoData[index].剧本完成进度 === '') {
                            mobileCard.classList.add('not-started');
                        } else {
                            mobileCard.classList.add('in-progress');
                        }
                        
                        // 更新进度摘要
                        const progressSummary = mobileCard.querySelector('.progress-summary');
                        if (progressSummary) {
                            progressSummary.textContent = getProgressSummary(videoData[index]);
                        }
                    }
                }
            }
        }

        // 页面加载时渲染卡片
        document.addEventListener('DOMContentLoaded', function() {
            renderMobileCards();
        });
    </script>
</body>
</html>
